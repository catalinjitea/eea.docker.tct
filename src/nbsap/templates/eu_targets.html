{% extends 'layout.html' %}

{% load i18n %}
{% block title %}
    <title>NBSAP - {% trans "EU Targets" %}</title>
{% endblock %}


{% block navmenu %}
  {% include 'nav_menu.html' %}
{% endblock %}

{% block sidebar %}
<div class="sidebar">
  <h4 class="sidebar-title">Targets</h4>
  <ul class="sidebar-menu">
    {% for target in targets %}
    <li {% if target.pk == current_target.pk %}class="active"{% endif %}>
      <a href="{% url 'eu_targets' code=target.code %}" title="{{ target.code }}">
        {% trans "Target" %} {{ target.code }}
      </a>
    </li>
    {% endfor %}
  </ul>
</div>
{% endblock %}

{% block content %}
  <h1 class="page-title">{% trans "EU Targets" %}</h1>

  <h1>{% trans "EU Target" %} {{ current_target.code }}: {{ current_target.title }}</h1>
  <p class="objective-description">{{ current_target.body }}</p>

  <div class="toc">
    <h5>{% trans "Table of contents"%}</h5>
    {% if current_target.actions_tree|length %}
    <ul>
      {% for action in current_target.actions_tree %}
      <li>
        <a href="#{{ action.code }}"
           rel="tooltip"
           data-placement="right"
           data-original-title="{{ action.description }}">
           {% trans "Action" %} {{ action.code }}
        </a>
      </li>
      {% endfor %}
    </ul>
    {% else %}
      <p>{% trans "No actions found" %}</p>
    {% endif %}
  </div>

  <div class ="well">
    <div class="well-title">{% trans "EU indicators/sub-indicators" %}</div>
    {% if current_target.indicators %}
    <ul>
      {% for indicator in current_target.indicators.all %}
        <li>
          {{ indicator.code }} {{indicator.title}}
          {% if indicator.parent.all %}
          <ul>
          {% for sub in indicator.parent.all %}
            <li>
              {% if sub.url %}
                <a href="{{ sub.url }}">
                  {{ sub.indicator_type|upper }} {{ sub.code }}: {{sub.title}}</a>
              {% else %}
                {{ sub.code }} {{ sub.title }}
              {% endif %}
              </li>
          {% endfor %}
          </ul>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    {% else %}
      <p>{% trans "No data available" %}.</p>
    {% endif %}
  </div>


  <div class ="well">
    <div class="well-title">{% trans "Mapping with Aichi Strategy" %}</div>
    {% if current_target.eu_aichi_strategy %}
      <ul>
        {% for strategy in current_target.eu_aichi_strategy.all %}
          {% for aichi_target in strategy.aichi_targets.all %}
            <li>
              <a href="#to_do">{% trans "AICHI Target"%} {{aichi_target.code}}</a>
            </li>
          {% endfor %}
        {% endfor %}
      </ul>
    {% else %}
      <p>{% trans "No data available" %}.</p>
    {% endif %}
  </div>


  {% for action in current_target.actions_tree %}
  <div class="section" id="{{ action.code }}">
    <h2>{% trans "Action" %} {{ action.code }}</h2>
    <p>{{ action.description }}</p>

    <div class="well">
      <div class="well-title">{% trans "Mapping with National Strategy" %}</div>
      {% if action.national_strategy.all %}
        <ul>
          {% for strategy in action.national_strategy.all %}
            <li>
              {% if strategy.objective.parent %}
              <a href="{% url 'nat_strategy' code=strategy.objective.parent.code %}#{{ strategy.objective.code }}">
                {% trans "Objective" %} {{strategy.objective.code}}
              </a>
              <p>{{ strategy.objective.title }} {{ strategy.objective.parent.code }}</p>
              {% else %}
              <a href="{% url 'nat_strategy' code=strategy.objective.code%}">
                {% trans "Objective" %} {{strategy.objective.code}}
              </a>
              <p>{{ strategy.objective.title }} {{ strategy.objective.code }}</p>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>{% trans "No data available" %}</p>
      {% endif %}
    </div>
  </div>
  {% endfor %}

  <div class="text-right">
    <a class="label label-info" href="#top">{% trans "Back to top" %}</a>
  </div>

{% endblock %}

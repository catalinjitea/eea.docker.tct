{% extends 'layout.html' %}
{% load i18n %}
{% load utils %}


{% block title %}
  NBSAP - {% trans "Implementation: Actions related to objectives" %}
{% endblock %}


{% block navmenu %}
  {% include '_bits/nav_menu.html' %}
{% endblock %}

{% block sidebar %}
  <div class="sidebar">
    <h4 class="sidebar-title">{% trans "Related actions" %}</h4>
    <ul class="sidebar-menu">
      {% if is_empty_page %}
        <li {% if not current_objective %} class="active" {% endif %}>
          <a href="{% url 'implementation_page' %}">{% trans "Intro" %}</a>
        </li>
      {% endif %}
      {% for objective in objectives|sort_by_code %}
        <li id="list-item" {% if objective.code == current_objective.code %}class="active"{% endif %}>
          <a href="{% url 'implementation' code=objective.code %}">
            {% trans "Objective" %} {{ objective.code }}
          </a> <a class="fa fa-caret-down" aria-hidden="true"></a>
              <ul class="sidebar-submenu">
                {% for action in objective.get_all_actions|sort_by_code %}
                  <li>
                    <a href="{% url 'implementation' code=objective.code %}#{{ action.code }}"
                       rel='tooltip'>
                      {% trans "Action" %} {{ action.code }}</a>
                  </li>
                {% endfor %}
              </ul>
        </li>
      {% endfor %}
    </ul>
  </div>
{% endblock %}


{% block content %}

  <h1 class="page-title">Implementation</h1>

  <h1 class="x-title">{% trans "Actions related to Objective" %} {{ current_objective.code }} </h1> <h2> {{ current_objective.title }} </h2>

  <div>
    <p>
      <a href="{% url 'nat_strategy' pk=current_objective.pk %}"
         title="{{ current_objective.code }}">
        See objective
      </a>
    </p>
  </div>

  {% if current_objective.actions_tree %}
    {% for action in current_objective.actions_tree|sort_by_code %}
      <div class="section" id="{{ action.code }}">
        <h3>{% trans "Action" %} {{ action.code }} </h3>
         <h4> {% if action.title %} {{ action.title|title }}{% endif %}
        </h4>

        <div class="summary">
          <div class="snippet">
            {{ action.description|striptags|safe }}
          </div>
          <div class="full">
            <div class="html-content">{{ action.description|safe }}</div>

            {% include 'manager/nat_strategy/mapping/nat_action_aichi_mapping.html' %}
          </div>
          <div>
            <p>
              <a href="{% url 'nat_strategy' pk=action.pk %}"
                 title="{{ action.code }}">
                See objective
              </a>
            </p>
          </div>
        </div>
      </div>
    {% endfor %}

  {% else %}
    <p>{% trans "No actions found" %}.</p>
  {% endif %}

  </div>

{% endblock content %}


{% block scripts %}
  <script>
    // $(function () {
    //   $('.more').on('click', function () {
    //     var parents = $(this).parents('.summary');
    //     var snippet = parents.find('.snippet');
    //     var full = parents.find('.full');

    //     snippet.hide();
    //     full.show();
    //   });
    //   $('.less').on('click', function () {
    //     var parents = $(this).parents('.summary');
    //     var snippet = parents.find('.snippet');
    //     var full = parents.find('.full');

    //     full.hide();
    //     snippet.show();
    //   });
    // });

  </script>
{% endblock scripts %}

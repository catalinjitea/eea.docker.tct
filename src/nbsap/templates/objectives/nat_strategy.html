{% extends 'layout.html' %}

{% load utils %}
{% load i18n %}

{% block title %}
  NBSAP - {% trans "National Strategy: Objectives" %}
{% endblock %}

{% block navmenu %}
  {% include '_bits/nav_menu.html' %}
{% endblock %}


{% block sidebar %}
<div id="nat-obj-list" class="sidebar">
  <h4 class="sidebar-title">{% trans "Objectives" %}</h4>
  <input class="search" placeholder="quick search" />
  <ul class="sidebar-menu list">
    {% for objective in objectives|sort_by_code %}
      <li class="{% if objective.pk == current_objective.pk %}active{% endif %} ">
        <a class="nat-objective" href="{% url 'nat_strategy' pk=objective.pk %}" title="{{ objective.code }}">
          {% trans "Objective" %} {{ objective.code }}
        </a>
      </li>
      {% if objective.objectives_tree|length %}
        {% for obj in objective.objectives_tree|sort_by_code %}
          <li class="{% if obj.pk == current_objective.pk %}active{% endif %} indent">
            <a class="nat-objective" href="{% url 'nat_strategy' pk=obj.pk %}">
               {% trans "Objective" %} {{ obj.code }}</a>
          </li>
        {% endfor %}
      {% endif %}
    {% endfor %}
  </ul>

  <div class="download-container">
    <a class="btn btn-success small" href="{% url 'nat_strategy_download' %}">
      {% trans "Download the mapping" %}
    </a>
  </div>
</div>
{% endblock %}


{% block content %}
<section class="content-header"></section>
  <h1 class="page-title">{% trans 'National Strategy' %}</h1>
  <h1 class="x-title">
    {% trans "Objective" %} {{ current_objective.code }}
    <h2>{% if current_objective.title %} {{ current_objective.title }} {% endif %}</h2>
  </h1>
  <div>
      <a class="quick-links" href="{% url 'implementation' code=current_objective.code %}" title="{{ current_objective.code }}">
      See implementation
      </a>
      <a class="quick-links" href="#aichi-mapping">Mapping with Aichi</a>
      <a class="quick-links" href="#nat-mapping">Mapping with National Indicators</a>
      <a class="quick-links" href="#eu-mapping">Mapping with EU</a>
  </div>
  <div class="summary">
    <div class="snippet">
      {{ current_objective.description|striptags|safe }}
    </div>
    <div class="full">
      {{ current_objective.description|safe }}
    </div>
  </div>

  <div class="pre-toc">
    {% include 'mapping/../manager/nat_strategy/mapping/nat_strategy_aichi_mapping.html' with subobj=current_objective %}

    {% if EU_STRATEGY %}
        {% include 'mapping/../manager/nat_strategy/mapping/nat_strategy_eu_mapping.html' with subobj=current_objective %}
    {% endif %}
  </div>


{% endblock %}


{% block scripts %}
  <script>
  // $(function () {
  //   $("[rel=tooltip]").tooltip();

  //   $('.more').on('click', function() {
  //     var parents = $(this).parents('.summary');
  //     var snippet = parents.find('.snippet');
  //     var full = parents.find('.full');

  //     snippet.hide();
  //     full.show();
  //   });

  //   $('.less').on('click', function() {
  //     var parents = $(this).parents('.summary');
  //     var snippet = parents.find('.snippet');
  //     var full = parents.find('.full');

  //     full.hide();
  //     snippet.show();
  //   });
  // });

  $(document).ready(function() {
    var options = {
      valueNames: [ 'nat-objective' ]
    };
    var userList = new List('nat-obj-list', options);
  });
  </script>
{% endblock scripts %}
